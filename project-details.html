<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShareBridge - Project Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <style>
        .detail-card { background-color: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .chart-container { height: 300px; }
        table { font-size: 0.9rem; }
        .forecast-card { background-color: #f8f9fa; border-radius: 8px; padding: 15px; }
        .forecast-card h4 { color: #007bff; }
        .sentiment-gauge { height: 100px; }
        .download-btn { background-color: #17a2b8; }
        .invest-btn { background-color: #007bff; }
        .badge-img { width: 50px; height: 50px; }
        .investor-badge { color: #28a745; font-weight: bold; }
        .timeframe-btn.active { background-color: #007bff; color: white; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="home.html"><img src="https://via.placeholder.com/40" alt="ShareBridge Logo"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="projects.html">Projects</a></li>
                    <li class="nav-item"><a class="nav-link" href="dashboard.html">Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="subscription.html">Subscription</a></li>
                    <li class="nav-item"><a class="nav-link" href="news.html">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="community.html">Community</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                </ul>
                <button class="btn btn-outline-light" onclick="login()">Login</button>
            </div>
        </div>
    </nav>

    <div class="container my-5">
        <h2 class="text-center mb-4" id="projectTitle">Project Details</h2>
        <div class="detail-card p-4">
            <div class="row">
                <div class="col-md-4">
                    <img src="https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3" class="img-fluid rounded mb-3" alt="Project Image">
                    <h4 class="font-bold">Overview</h4>
                    <p id="projectBio">Loading bio...</p>
                    <p><strong>Current Share Value:</strong> <span id="shareValue">$0.00</span></p>
                    <p><strong>Status:</strong> <span id="projectStatus">Loading...</span></p>
                    <p><strong>Investors:</strong> <span id="investorCount">0</span> active investors</p>
                    <p><strong>Compliance:</strong> <img src="https://via.placeholder.com/50?text=SEC" alt="SEC Compliance" class="badge-img" title="SEC Compliant"></p>
                    <p><strong>Investor Badge:</strong> <span id="investorBadge" class="investor-badge">None</span></p>
                    <button class="btn invest-btn text-white mt-3" onclick="invest()">Invest Now</button>
                    <button class="btn btn-outline-info mt-2" onclick="toggleAlerts()">Toggle Alerts</button>
                </div>
                <div class="col-md-8">
                    <h4 class="font-bold">Portfolio Simulator (Premium)</h4>
                    <div class="mb-4">
                        <input type="number" id="investmentAmount" class="form-control mb-2" placeholder="Enter investment amount ($)" min="0">
                        <select id="timeframeSimulator" class="form-select mb-2">
                            <option value="30Day">30 Days</option>
                            <option value="6Month">6 Months</option>
                            <option value="1Year">1 Year</option>
                        </select>
                        <button class="btn btn-primary" onclick="simulateInvestment()">Simulate Returns</button>
                        <p id="simulationResult" class="mt-2">Enter amount to see projected returns.</p>
                    </div>
                    <h4 class="font-bold">Historical Share Value</h4>
                    <div class="chart-container mb-4">
                        <canvas id="historicalChart"></canvas>
                    </div>
                    <h4 class="font-bold">Financial Reports</h4>
                    <div class="mb-4">
                        <table class="table table-striped">
                            <thead><tr><th>Period</th><th>Revenue</th><th>Profit</th><th>Expenses</th></tr></thead>
                            <tbody id="financialTable">
                                <tr><td>Loading...</td><td>-</td><td>-</td><td>-</td></tr>
                            </tbody>
                        </table>
                        <button class="btn download-btn text-white" onclick="downloadFinancialsCSV()">Export Financials as CSV</button>
                    </div>
                    <h4 class="font-bold">Capital</h4>
                    <p><strong>Total Capital Raised:</strong> <span id="capitalRaised">$0</span></p>
                    <p><strong>Funding Rounds:</strong> <span id="fundingRounds">0</span></p>
                    <h4 class="font-bold">AI-Predicted Share Value & Profitability</h4>
                    <div class="forecast-card mb-4">
                        <div class="d-flex gap-2 mb-2">
                            <button class="btn btn-outline-primary timeframe-btn active" onclick="updateForecastChart('30Day')">30 Days</button>
                            <button class="btn btn-outline-primary timeframe-btn" onclick="updateForecastChart('6Month')">6 Months</button>
                            <button class="btn btn-outline-primary timeframe-btn" onclick="updateForecastChart('1Year')">1 Year</button>
                        </div>
                        <p><strong>30-Day Forecast:</strong> <span id="forecast30Day">$0 (Confidence: 0%)</span></p>
                        <p><strong>6-Month Forecast:</strong> <span id="forecast6Month">$0 (Confidence: 0%)</span></p>
                        <p><strong>1-Year Forecast:</strong> <span id="forecast1Year">$0 (Confidence: 0%)</span></p>
                        <p><strong>Profitability Estimate:</strong> <span id="profitability">0% ROI (Based on financial trends)</span></p>
                        <div class="chart-container">
                            <canvas id="forecastChart"></canvas>
                        </div>
                    </div>
                    <h4 class="font-bold">Risk Assessment</h4>
                    <p><strong>Risk Score:</strong> <span id="riskScore">Loading...</span> (AI-driven based on financial stability and market trends)</p>
                    <h4 class="font-bold">Investor Sentiment (NLP Analysis)</h4>
                    <div class="sentiment-gauge mb-4">
                        <canvas id="sentimentGauge"></canvas>
                    </div>
                    <h4 class="font-bold">Industry Comparison</h4>
                    <table class="table table-striped mb-4">
                        <thead><tr><th>Metric</th><th>Project</th><th>Industry Avg</th></tr></thead>
                        <tbody id="comparisonTable">
                            <tr><td>Loading...</td><td>-</td><td>-</td></tr>
                        </tbody>
                    </table>
                    <h4 class="font-bold">Recent News</h4>
                    <ul class="list-disc pl-5 mb-4" id="newsList">
                        <li>Loading...</li>
                    </ul>
                    <div class="d-flex gap-2">
                        <button class="btn download-btn text-white" onclick="downloadPortfolio()">Download Project Portfolio</button>
                        <button class="btn download-btn text-white" onclick="downloadFinancials()">Download Financial Report</button>
                    </div>
                    <p class="mt-3 text-muted">Premium users (VIP/Platinum) unlock advanced analytics and detailed forecasts. <a href="subscription.html">Upgrade now</a>.</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white text-center py-3">
        <p>&copy; 2025 ShareBridge. All rights reserved.</p>
        <a href="contact.html" class="text-white">Contact Us</a>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Mock project data
        const projects = {
            1: {
                name: 'Tech Innovate',
                bio: 'Tech Innovate is a leader in AI and cloud computing, delivering cutting-edge solutions for enterprise and consumer markets. Founded in 2015, the company focuses on scalable, secure technologies.',
                shareValue: 150.25,
                status: 'Active',
                investorCount: 500,
                investorBadge: 'Top Investor',
                historicalData: [140, 145, 150, 148, 150.25],
                forecastData: {
                    '30Day': [150.25, 152, 154, 155.50],
                    '6Month': [150.25, 155, 160, 165.75],
                    '1Year': [150.25, 160, 170, 180.00]
                },
                financials: [
                    { period: 'Q1 2025', revenue: 5000000, profit: 1200000, expenses: 3800000 },
                    { period: 'Q4 2024', revenue: 4800000, profit: 1100000, expenses: 3700000 },
                    { period: 'Annual 2024', revenue: 19000000, profit: 4500000, expenses: 14500000 }
                ],
                capitalRaised: 20000000,
                fundingRounds: 3,
                forecast: { '30Day': { value: 155.50, confidence: 85 }, '6Month': { value: 165.75, confidence: 78 }, '1Year': { value: 180.00, confidence: 72 } },
                profitability: '12% ROI (Projected based on revenue growth)',
                riskScore: 'Low',
                sentiment: 80, // 0-100 (bullish)
                comparison: { peRatio: 25, industryPeRatio: 30, roi: 12, industryRoi: 10 },
                news: ['New product launch announced (Sentiment: Positive)', 'Q2 earnings exceed expectations (Sentiment: Positive)']
            },
            2: {
                name: 'Green Energy Co',
                bio: 'Green Energy Co develops sustainable energy solutions, focusing on solar and wind technologies. Established in 2018, it aims to reduce carbon footprints globally.',
                shareValue: 85.50,
                status: 'Stable',
                investorCount: 300,
                investorBadge: 'Green Pioneer',
                historicalData: [80, 82, 84, 85, 85.50],
                forecastData: {
                    '30Day': [85.50, 86, 86.8, 87.20],
                    '6Month': [85.50, 87, 88.5, 90.10],
                    '1Year': [85.50, 88, 92, 95.00]
                },
                financials: [
                    { period: 'Q1 2025', revenue: 3000000, profit: 800000, expenses: 2200000 },
                    { period: 'Q4 2024', revenue: 2900000, profit: 750000, expenses: 2150000 },
                    { period: 'Annual 2024', revenue: 11500000, profit: 3000000, expenses: 8500000 }
                ],
                capitalRaised: 15000000,
                fundingRounds: 2,
                forecast: { '30Day': { value: 87.20, confidence: 82 }, '6Month': { value: 90.10, confidence: 75 }, '1Year': { value: 95.00, confidence: 70 } },
                profitability: '8% ROI (Projected based on contract growth)',
                riskScore: 'Medium',
                sentiment: 60,
                comparison: { peRatio: 20, industryPeRatio: 22, roi: 8, industryRoi: 7 },
                news: ['Signed major contract with utility provider (Sentiment: Positive)']
            },
            3: {
                name: 'BioHealth Inc',
                bio: 'BioHealth Inc is a biotech pioneer specializing in innovative healthcare solutions, including novel therapeutics and diagnostics. Founded in 2017.',
                shareValue: 200.75,
                status: 'High Growth',
                investorCount: 600,
                investorBadge: 'Bio Innovator',
                historicalData: [190, 195, 198, 200, 200.75],
                forecastData: {
                    '30Day': [200.75, 205, 208, 210.50],
                    '6Month': [200.75, 215, 225, 230.25],
                    '1Year': [200.75, 230, 240, 250.00]
                },
                financials: [
                    { period: 'Q1 2025', revenue: 7500000, profit: 2000000, expenses: 5500000 },
                    { period: 'Q4 2024', revenue: 7200000, profit: 1800000, expenses: 5400000 },
                    { period: 'Annual 2024', revenue: 28000000, profit: 7500000, expenses: 20500000 }
                ],
                capitalRaised: 30000000,
                fundingRounds: 4,
                forecast: { '30Day': { value: 210.50, confidence: 88 }, '6Month': { value: 230.25, confidence: 80 }, '1Year': { value: 250.00, confidence: 74 } },
                profitability: '15% ROI (Projected based on FDA approvals)',
                riskScore: 'Medium',
                sentiment: 90,
                comparison: { peRatio: 35, industryPeRatio: 40, roi: 15, industryRoi: 12 },
                news: ['FDA approval for new drug (Sentiment: Positive)', 'Partnership with global pharma (Sentiment: Positive)']
            },
            4: {
                name: 'Quantum Computing Ltd',
                bio: 'Quantum Computing Ltd is advancing quantum computing technologies for applications in cryptography, AI, and materials science. Founded in 2020.',
                shareValue: 120.30,
                status: 'Active',
                investorCount: 400,
                investorBadge: 'Quantum Leader',
                historicalData: [110, 115, 118, 120, 120.30],
                forecastData: {
                    '30Day': [120.30, 122, 124, 125.10],
                    '6Month': [120.30, 128, 132, 135.50],
                    '1Year': [120.30, 135, 140, 145.00]
                },
                financials: [
                    { period: 'Q1 2025', revenue: 4000000, profit: 900000, expenses: 3100000 },
                    { period: 'Q4 2024', revenue: 3800000, profit: 850000, expenses: 2950000 },
                    { period: 'Annual 2024', revenue: 15000000, profit: 3400000, expenses: 11600000 }
                ],
                capitalRaised: 18000000,
                fundingRounds: 2,
                forecast: { '30Day': { value: 125.10, confidence: 84 }, '6Month': { value: 135.50, confidence: 77 }, '1Year': { value: 145.00, confidence: 71 } },
                profitability: '10% ROI (Projected based on R&D progress)',
                riskScore: 'High',
                sentiment: 70,
                comparison: { peRatio: 28, industryPeRatio: 32, roi: 10, industryRoi: 9 },
                news: ['Breakthrough in quantum algorithms (Sentiment: Positive)']
            }
        };

        // Load project data based on URL query parameter
        const urlParams = new URLSearchParams(window.location.search);
        const projectId = urlParams.get('id');
        const project = projects[projectId] || projects[1]; // Default to Tech Innovate if ID invalid

        // Update page content
        document.getElementById('projectTitle').textContent = `${project.name} Portfolio`;
        document.getElementById('projectBio').textContent = project.bio;
        document.getElementById('shareValue').textContent = `$${project.shareValue.toFixed(2)}`;
        document.getElementById('projectStatus').textContent = project.status;
        document.getElementById('investorCount').textContent = project.investorCount;
        document.getElementById('investorBadge').textContent = project.investorBadge;
        document.getElementById('capitalRaised').textContent = `$${project.capitalRaised.toLocaleString()}`;
        document.getElementById('fundingRounds').textContent = project.fundingRounds;
        document.getElementById('forecast30Day').textContent = `$${project.forecast['30Day'].value.toFixed(2)} (Confidence: ${project.forecast['30Day'].confidence}%)`;
        document.getElementById('forecast6Month').textContent = `$${project.forecast['6Month'].value.toFixed(2)} (Confidence: ${project.forecast['6Month'].confidence}%)`;
        document.getElementById('forecast1Year').textContent = `$${project.forecast['1Year'].value.toFixed(2)} (Confidence: ${project.forecast['1Year'].confidence}%)`;
        document.getElementById('profitability').textContent = project.profitability;
        document.getElementById('riskScore').textContent = project.riskScore;

        // Financial Table
        const financialTable = document.getElementById('financialTable');
        financialTable.innerHTML = project.financials.map(f => `
            <tr>
                <td>${f.period}</td>
                <td>$${f.revenue.toLocaleString()}</td>
                <td>$${f.profit.toLocaleString()}</td>
                <td>$${f.expenses.toLocaleString()}</td>
            </tr>
        `).join('');

        // Comparison Table
        const comparisonTable = document.getElementById('comparisonTable');
        comparisonTable.innerHTML = `
            <tr><td>P/E Ratio</td><td>${project.comparison.peRatio}</td><td>${project.comparison.industryPeRatio}</td></tr>
            <tr><td>ROI</td><td>${project.comparison.roi}%</td><td>${project.comparison.industryRoi}%</td></tr>
        `;

        // News List with Sentiment
        const newsList = document.getElementById('newsList');
        newsList.innerHTML = project.news.map(n => `<li>${n}</li>`).join('');

        // Chart.js Zoom Plugin Setup
        Chart.register(ChartZoom);

        // Historical Chart
        new Chart(document.getElementById('historicalChart'), {
            type: 'line',
            data: {
                labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5'],
                datasets: [{ label: 'Share Value', data: project.historicalData, borderColor: '#007bff', fill: false }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { zoom: { zoom: { wheel: { enabled: true }, pinch: { enabled: true }, mode: 'xy' } } } }
        });

        // Forecast Chart
        let forecastChart = new Chart(document.getElementById('forecastChart'), {
            type: 'line',
            data: {
                labels: ['Today', 'Day 10', 'Day 20', 'Day 30'],
                datasets: [{ label: 'Predicted Value', data: project.forecastData['30Day'], borderColor: '#007bff', borderDash: [5, 5], fill: false }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        // Sentiment Gauge
        new Chart(document.getElementById('sentimentGauge'), {
            type: 'doughnut',
            data: {
                labels: ['Bullish', 'Neutral'],
                datasets: [{ data: [project.sentiment, 100 - project.sentiment], backgroundColor: ['#28a745', '#6c757d'] }]
            },
            options: { responsive: true, maintainAspectRatio: false, cutout: '70%' }
        });

        // Financial Chart
        new Chart(document.getElementById('financialChart'), {
            type: 'bar',
            data: {
                labels: project.financials.map(f => f.period),
                datasets: [
                    { label: 'Revenue', data: project.financials.map(f => f.revenue), backgroundColor: '#007bff' },
                    { label: 'Profit', data: project.financials.map(f => f.profit), backgroundColor: '#28a745' },
                    { label: 'Expenses', data: project.financials.map(f => f.expenses), backgroundColor: '#dc3545' }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        // Interactive Timeframe Selector
        function updateForecastChart(timeframe) {
            const buttons = document.querySelectorAll('.timeframe-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const labels = {
                '30Day': ['Today', 'Day 10', 'Day 20', 'Day 30'],
                '6Month': ['Today', 'Month 2', 'Month 4', 'Month 6'],
                '1Year': ['Today', 'Month 4', 'Month 8', 'Month 12']
            };

            forecastChart.data.labels = labels[timeframe];
            forecastChart.data.datasets[0].data = project.forecastData[timeframe];
            forecastChart.update();
        }

        // Portfolio Simulator
        function simulateInvestment() {
            const isPremium = false; // Mock: Check if user is VIP/Platinum
            if (!isPremium) {
                alert('Portfolio Simulator is available for VIP/Platinum users only. Please upgrade.');
                return;
            }
            const amount = parseFloat(document.getElementById('investmentAmount').value);
            const timeframe = document.getElementById('timeframeSimulator').value;
            if (isNaN(amount) || amount <= 0) {
                document.getElementById('simulationResult').textContent = 'Please enter a valid investment amount.';
                return;
            }
            const currentPrice = project.shareValue;
            const futurePrice = project.forecast[timeframe].value;
            const shares = amount / currentPrice;
            const projectedValue = shares * futurePrice;
            const roi = ((projectedValue - amount) / amount * 100).toFixed(2);
            document.getElementById('simulationResult').textContent = `Projected Value: $${projectedValue.toFixed(2)} (ROI: ${roi}%)`;
        }

        // Real-Time Alerts
        function toggleAlerts() {
            const isSubscribed = document.querySelector('.btn-outline-info').textContent === 'Disable Alerts';
            document.querySelector('.btn-outline-info').textContent = isSubscribed ? 'Enable Alerts' : 'Disable Alerts';
            alert(`${isSubscribed ? 'Unsubscribed from' : 'Subscribed to'} real-time alerts for ${project.name}`);
            // Placeholder for WebSocket/email alert toggle
        }

        // Download Functions
        function downloadPortfolio() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text(`${project.name} Portfolio`, 10, 10);
            doc.text(`Bio: ${project.bio}`, 10, 20);
            doc.text(`Share Value: $${project.shareValue.toFixed(2)}`, 10, 30);
            doc.text(`Status: ${project.status}`, 10, 40);
            doc.text(`Investors: ${project.investorCount}`, 10, 50);
            doc.save(`${project.name}_Portfolio.pdf`);
        }

        function downloadFinancials() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.text(`${project.name} Financial Report`, 10, 10);
            project.financials.forEach((f, i) => {
                doc.text(`${f.period}: Revenue $${f.revenue.toLocaleString()}, Profit $${f.profit.toLocaleString()}, Expenses $${f.expenses.toLocaleString()}`, 10, 20 + i * 10);
            });
            doc.save(`${project.name}_Financials.pdf`);
        }

        function downloadFinancialsCSV() {
            const isPremium = false; // Mock: Check if user is VIP/Platinum
            if (!isPremium) {
                alert('CSV export is available for VIP/Platinum users only. Please upgrade.');
                return;
            }
            const csvContent = [
                'Period,Revenue,Profit,Expenses',
                ...project.financials.map(f => `${f.period},${f.revenue},${f.profit},${f.expenses}`)
            ].join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${project.name}_Financials.csv`;
            link.click();
        }

        function invest() {
            alert(`Redirecting to investment page for ${project.name}`);
            // Placeholder for investment logic
        }
        function login() {
            alert("Redirecting to login page...");
            // Placeholder for login logic
        }
    </script>
</body>
</html>